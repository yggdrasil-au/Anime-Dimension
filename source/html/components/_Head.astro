---
// /source/html/components/_Head.astro

// get page specific values from caller page
const { title, description } = Astro.props

// get global build data/config/methods from shared build config js
import * as buildconf from "@BuildConfigs/main.js";
var { deploymentPath, thisCanon } = buildconf.resolvedepPath(Astro.url.pathname);

---

<meta charset="utf8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>{title}</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="canonical" href={thisCanon} />
<link rel="deploymentPath" href={deploymentPath} />


<link rel="icon" href="/assets/favicon.webp" />

<link rel="manifest" href="/site.webmanifest" />
<script is:inline src="/js/register-service-worker.min.js" type="module"></script>

<!-- Expose API base once for the whole app -->
<meta data-api-base={buildconf.apiBase} />
<script is:inline>
    // Make available on window as AD_API_BASE for legacy code
    // todo: get value from meta tag instead
    // this wont work, astro cant inject values into js script blocks
    window.AD_API_BASE = "{buildconf.apiBase}";
    document.documentElement.style.setProperty('--ad-api-base', "{buildconf.apiBase}");
    console.debug('[AD] API base:', "{buildconf.apiBase}");
</script>

<script is:inline>
    // --- Initial theme load to prevent FOUC ---
    /*(function () {
        const theme = localStorage.getItem("theme") || "night"; // Default to "night" if no theme is set
        if (theme === "night") {
            // Set the base theme to "dark" for Bootstrap compatibility
            document.documentElement.setAttribute(
                "data-bs-theme",
                "dark",
            );
            // Add your custom class for night-mode styles
            document.documentElement.classList.add("night-mode");
        } else if (theme === "auto") {
            const prefersDark = globalThis.matchMedia(
                "(prefers-color-scheme: dark)",
            ).matches;
            document.documentElement.setAttribute(
                "data-bs-theme",
                prefersDark ? "dark" : "light",
            );
        } else {
            document.documentElement.setAttribute(
                "data-bs-theme",
                theme,
            );
        }
    })();*/
</script>

<script is:inline src="/js/capacitorinit.js"></script>
<script is:inline src="/js/ionic.js"></script>


<!--begin::Accessibility Meta Tags-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<meta name="color-scheme" content="light dark" />
<meta name="theme-color" content="#007bff" media="(prefers-color-scheme: light)" />
<meta name="theme-color" content="#1a1a1a" media="(prefers-color-scheme: dark)" />
<!--end::Accessibility Meta Tags-->

<!--begin::Primary Meta Tags-->
<meta name="title" content={title} />
<meta name="author" content="Samarixum" />
<meta name="description" content={description} />
<meta name="keywords" content="" />
<!--end::Primary Meta Tags-->

<!--begin::Accessibility Features-->
<!-- Skip links will be dynamically added by accessibility.js -->
<meta name="supported-color-schemes" content="light dark" />
{
    /**
     *  Main CSS file
     *  This file contains the main styles for the application.
     *  It is required for the layout and themes to work.
     *  it is preloaded for performance.
     */
}
<link rel="preload" href={deploymentPath + "css/main.min.css"} as="style" />
<!--end::Accessibility Features-->

<link rel="stylesheet" href={deploymentPath + "css/main.min.css"} />
